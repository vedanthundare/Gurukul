import { createSlice } from "@reduxjs/toolkit";

// Get initial language from localStorage or default to English
const getInitialLanguage = () => {
  try {
    const settings = localStorage.getItem("gurukul_settings");
    if (settings) {
      const parsed = JSON.parse(settings);
      return parsed.language || "english";
    }
    return "english";
  } catch (error) {
    console.error("Error reading language from storage:", error);
    return "english";
  }
};

// All translations in one place
export const translations = {
  hindi: {
    Gurukul: "рдЧреБрд░реБрдХреБрд▓",
    "Sign Out": "рд╕рд╛рдЗрди рдЖрдЙрдЯ",
    "A modern rebirth of ancient Indian wisdom, brought to life through AI, storytelling, and immersive technology.":
      "AI, рдХрд╣рд╛рдиреА рдФрд░ рдЗрдорд░реНрд╕рд┐рд╡ рддрдХрдиреАрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬреАрд╡рди рдореЗрдВ рд▓рд╛рдП рдЧрдП рдкреНрд░рд╛рдЪреАрди рднрд╛рд░рддреАрдп рдЬреНрдЮрд╛рди рдХрд╛ рдЖрдзреБрдирд┐рдХ рдкреБрдирд░реНрдЬрдиреНрдоред",
    You: "рдЖрдк",
    "Guru AI": "рдЧреБрд░реБ рдПрдЖрдИ",
    Appearance: "рдкреНрд░рджрд░реНрд╢рди",
    // Settings page
    Settings: "рд╕реЗрдЯрд┐рдВрдЧреНрд╕",
    "Customize your Gurukul experience by adjusting these settings.":
      "рдЗрди рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рдХреЗ рдЕрдкрдиреЗ рдЧреБрд░реБрдХреБрд▓ рдЕрдиреБрднрд╡ рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░реЗрдВред",
    Display: "рдкреНрд░рджрд░реНрд╢рди",
    "Font Size (Browser Zoom)": "рдлрд╝реЙрдиреНрдЯ рдЖрдХрд╛рд░ (рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЬрд╝реВрдо)",
    Small: "рдЫреЛрдЯрд╛",
    Medium: "рдордзреНрдпрдо",
    Large: "рдмрдбрд╝рд╛",
    Preferences: "рдкреНрд░рд╛рдердорд┐рдХрддрд╛рдПрдБ",
    Language: "рднрд╛рд╖рд╛",
    English: "рдЕрдВрдЧреНрд░реЗрдЬрд╝реА",
    Hindi: "рд╣рд┐рдиреНрджреА",
    "Enable Notifications": "рд╕реВрдЪрдирд╛рдПрдВ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ",
    Account: "рдЦрд╛рддрд╛",
    "Change Password": "рдкрд╛рд╕рд╡рд░реНрдб рдмрджрд▓реЗрдВ",
    "Delete Account": "рдЦрд╛рддрд╛ рд╣рдЯрд╛рдПрдВ",
    "Save Changes": "рдкрд░рд┐рд╡рд░реНрддрди рд╕рд╣реЗрдЬреЗрдВ",
    "Settings saved successfully!": "рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд╕рд╣реЗрдЬреА рдЧрдИрдВ!",
    "English language selected": "рдЕрдВрдЧреНрд░реЗрдЬрд╝реА рднрд╛рд╖рд╛ рдЪреБрдиреА рдЧрдИ",
    "Hindi language selected": "рд╣рд┐рдВрджреА рднрд╛рд╖рд╛ рдЪреБрдиреА рдЧрдИ",
    "Zoomed in": "рдЬрд╝реВрдо рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛",
    "Zoomed out": "рдЬрд╝реВрдо рдЖрдЙрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛",
    "Zoom reset": "рдЬрд╝реВрдо рд░реАрд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛",
    "Password reset email sent! Please check your inbox.":
      "рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдИрдореЗрд▓ рднреЗрдЬ рджреА рдЧрдИ рд╣реИ! рдХреГрдкрдпрд╛ рдЕрдкрдирд╛ рдЗрдирдмреЙрдХреНрд╕ рджреЗрдЦреЗрдВред",
    "Failed to send password reset email. Please try again.":
      "рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдИрдореЗрд▓ рднреЗрдЬрдиреЗ рдореЗрдВ рд╡рд┐рдлрд▓ред рдХреГрдкрдпрд╛ рдкреБрдирдГ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред",
    "Confirm Account Deletion": "рдЦрд╛рддрд╛ рд╣рдЯрд╛рдиреЗ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░реЗрдВ",
    "This action is permanent and cannot be undone. All your data will be permanently erased.":
      "рдпрд╣ рдХреНрд░рд┐рдпрд╛ рд╕реНрдерд╛рдпреА рд╣реИ рдФрд░ рдЗрд╕реЗ рд╡рд╛рдкрд╕ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЖрдкрдХрд╛ рд╕рднреА рдбреЗрдЯрд╛ рд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рдорд┐рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред",
    "Please enter your password to confirm:":
      "рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреГрдкрдпрд╛ рдЕрдкрдирд╛ рдкрд╛рд╕рд╡рд░реНрдб рджрд░реНрдЬ рдХрд░реЗрдВ:",
    "Enter your password": "рдЕрдкрдирд╛ рдкрд╛рд╕рд╡рд░реНрдб рджрд░реНрдЬ рдХрд░реЗрдВ",
    Cancel: "рд░рджреНрдж рдХрд░реЗрдВ",
    "Confirm Deletion": "рд╣рдЯрд╛рдиреЗ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░реЗрдВ",
    "Please enter your password to confirm account deletion":
      "рдЦрд╛рддрд╛ рд╣рдЯрд╛рдиреЗ рдХреА рдкреБрд╖реНрдЯрд┐ рдХреЗ рд▓рд┐рдП рдХреГрдкрдпрд╛ рдЕрдкрдирд╛ рдкрд╛рд╕рд╡рд░реНрдб рджрд░реНрдЬ рдХрд░реЗрдВ",
    "Incorrect password. Please try again.":
      "рдЧрд▓рдд рдкрд╛рд╕рд╡рд░реНрдбред рдХреГрдкрдпрд╛ рдкреБрдирдГ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред",
    "Account deleted. You will be signed out.":
      "рдЦрд╛рддрд╛ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЖрдк рд╕рд╛рдЗрди рдЖрдЙрдЯ рд╣реЛ рдЬрд╛рдПрдВрдЧреЗред",
    "Error deleting account. Please try again.":
      "рдЦрд╛рддрд╛ рд╣рдЯрд╛рдиреЗ рдореЗрдВ рддреНрд░реБрдЯрд┐ред рдХреГрдкрдпрд╛ рдкреБрдирдГ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред",
    "An unexpected error occurred. Please try again.":
      "рдПрдХ рдЕрдирдкреЗрдХреНрд╖рд┐рдд рддреНрд░реБрдЯрд┐ рд╣реБрдИред рдХреГрдкрдпрд╛ рдкреБрдирдГ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред",

    // Navigation
    Home: "рд╣реЛрдо",
    Dashboard: "рдбреИрд╢рдмреЛрд░реНрдб",
    Subjects: "рд╡рд┐рд╖рдп",
    Summarizer: "рд╕реАрдЦреЗрдВ",
    Chatbot: "рдЪреИрдЯрдмреЙрдЯ",
    About: "рд╣рдорд╛рд░реЗ рдмрд╛рд░реЗ рдореЗрдВ",
    "3D Models": "3рдбреА рдореЙрдбрд▓",

    // 3D Model Viewer
    "3D Cultural Models": "3рдбреА рд╕рд╛рдВрд╕реНрдХреГрддрд┐рдХ рдореЙрдбрд▓",
    "3D Model Viewer Coming Soon": "3рдбреА рдореЙрдбрд▓ рд╡реНрдпреВрдЕрд░ рдЬрд▓реНрдж рдЖ рд░рд╣рд╛ рд╣реИ",
    "We're currently working on implementing our 3D cultural models viewer. This feature will allow you to explore traditional architecture and cultural artifacts in interactive 3D space.":
      "рд╣рдо рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдЕрдкрдиреЗ 3рдбреА рд╕рд╛рдВрд╕реНрдХреГрддрд┐рдХ рдореЙрдбрд▓ рд╡реНрдпреВрдЕрд░ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдкрд░ рдХрд╛рдо рдХрд░ рд░рд╣реЗ рд╣реИрдВред рдпрд╣ рд╕реБрд╡рд┐рдзрд╛ рдЖрдкрдХреЛ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ 3рдбреА рд╕реНрдкреЗрд╕ рдореЗрдВ рдкрд╛рд░рдВрдкрд░рд┐рдХ рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдФрд░ рд╕рд╛рдВрд╕реНрдХреГрддрд┐рдХ рдХрд▓рд╛рдХреГрддрд┐рдпреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧреАред",
    "Get Notified When Available": "рдЬрдм рдЙрдкрд▓рдмреНрдз рд╣реЛ рддрдм рд╕реВрдЪрд┐рдд рд╣реЛрдВ",

    // Common UI elements
    "Sign In": "рд╕рд╛рдЗрди рдЗрди",
    "Sign Up": "рд╕рд╛рдЗрди рдЕрдк",
    Search: "рдЦреЛрдЬреЗрдВ",
    Submit: "рдЬрдорд╛ рдХрд░реЗрдВ",
    Loading: "рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ",
    Welcome: "рд╕реНрд╡рд╛рдЧрдд рд╣реИ",
    Profile: "рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓",
    Notifications: "рд╕реВрдЪрдирд╛рдПрдБ",
    Messages: "рд╕рдВрджреЗрд╢",
    Help: "рд╕рд╣рд╛рдпрддрд╛",
    Error: "рддреНрд░реБрдЯрд┐",
    Success: "рд╕рдлрд▓рддрд╛",

    // Dashboard page
    "User Dashboard": "рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреИрд╢рдмреЛрд░реНрдб",
    "Welcome back! Your progress and tokens will appear here soon.":
      "рд╡рд╛рдкрд╕ рдЖрдиреЗ рдкрд░ рд╕реНрд╡рд╛рдЧрдд рд╣реИ! рдЖрдкрдХреА рдкреНрд░рдЧрддрд┐ рдФрд░ рдЯреЛрдХрди рдЬрд▓реНрдж рд╣реА рдпрд╣рд╛рдВ рджрд┐рдЦрд╛рдИ рджреЗрдВрдЧреЗред",
    "Your Progress": "рдЖрдкрдХреА рдкреНрд░рдЧрддрд┐",
    "Recent Activity": "рд╣рд╛рд▓ рдХреА рдЧрддрд┐рд╡рд┐рдзрд┐",
    "Completed Lessons": "рдкреВрд░реНрдг рдкрд╛рда",
    "Ongoing Courses": "рдЪрд╛рд▓реВ рдкрд╛рдареНрдпрдХреНрд░рдо",
    "Achievement Points": "рдЙрдкрд▓рдмреНрдзрд┐ рдЕрдВрдХ",
    "Knowledge Tokens": "рдЬреНрдЮрд╛рди рдЯреЛрдХрди",
    "View All": "рд╕рднреА рджреЗрдЦреЗрдВ",
    "Continue Learning": "рд╕реАрдЦрдирд╛ рдЬрд╛рд░реА рд░рдЦреЗрдВ",
    "Start New Course": "рдирдпрд╛ рдкрд╛рдареНрдпрдХреНрд░рдо рд╢реБрд░реВ рдХрд░реЗрдВ",
    "Recommended for You": "рдЖрдкрдХреЗ рд▓рд┐рдП рдЕрдиреБрд╢рдВрд╕рд┐рдд",

    // Subject page
    "Explore Subjects": "рд╡рд┐рд╖рдпреЛрдВ рдХрд╛ рдЕрдиреНрд╡реЗрд╖рдг рдХрд░реЗрдВ",
    "Ancient Texts": "рдкреНрд░рд╛рдЪреАрди рдЧреНрд░рдВрде",
    "Vedic Mathematics": "рд╡реИрджрд┐рдХ рдЧрдгрд┐рдд",
    Sanskrit: "рд╕рдВрд╕реНрдХреГрдд",
    "Yoga & Meditation": "рдпреЛрдЧ рдФрд░ рдзреНрдпрд╛рди",
    Ayurveda: "рдЖрдпреБрд░реНрд╡реЗрдж",
    "Traditional Arts": "рдкрд╛рд░рдВрдкрд░рд┐рдХ рдХрд▓рд╛",
    Philosophy: "рджрд░реНрд╢рдирд╢рд╛рд╕реНрддреНрд░",
    "View Subject": "рд╡рд┐рд╖рдп рджреЗрдЦреЗрдВ",

    // Chatbot page
    "Ask Guru": "рдЧреБрд░реБ рд╕реЗ рдкреВрдЫреЗрдВ",
    "Type your question here...": "рдЕрдкрдирд╛ рдкреНрд░рд╢реНрди рдпрд╣рд╛рдВ рдЯрд╛рдЗрдк рдХрд░реЗрдВ...",
    Send: "рднреЗрдЬреЗрдВ",
    "AI is thinking...": "AI рд╕реЛрдЪ рд░рд╣рд╛ рд╣реИ...",
    "Try asking about Vedas, Yoga, Ayurveda, or ancient Indian wisdom.":
      "рд╡реЗрдж, рдпреЛрдЧ, рдЖрдпреБрд░реНрд╡реЗрдж, рдпрд╛ рдкреНрд░рд╛рдЪреАрди рднрд╛рд░рддреАрдп рдЬреНрдЮрд╛рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкреВрдЫрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред",
    "Powered by GPT": "GPT рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд",
    "Chat History": "рдЪреИрдЯ рдЗрддрд┐рд╣рд╛рд╕",
    "Clear Chat": "рдЪреИрдЯ рд╕рд╛рдл рдХрд░реЗрдВ",
    "Welcome to Gurukul": "рдЧреБрд░реБрдХреБрд▓ рдореЗрдВ рдЖрдкрдХрд╛ рд╕реНрд╡рд╛рдЧрдд рд╣реИ",
    "Get Started": "рд╢реБрд░реВ рдХрд░реЗрдВ",
    "Namaste!ЁЯЩП I am UniGuru, your AI learning assistant. How can I help you learn today?":
      "рдирдорд╕реНрддреЗ! рдореИрдВ рдЧреБрд░реБ рд╣реВрдБ, рдЖрдкрдХрд╛ AI рд▓рд░реНрдирд┐рдВрдЧ рд╕рд╣рд╛рдпрдХред рдореИрдВ рдЖрдЬ рдЖрдкрдХреА рдХреИрд╕реЗ рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реВрдБ?",
    "Ask about ancient Indian wisdom...":
      "рдкреНрд░рд╛рдЪреАрди рднрд╛рд░рддреАрдп рдЬреНрдЮрд╛рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкреВрдЫреЗрдВ...",
    "This AI assistant is designed to help you learn about ancient Indian wisdom and philosophy.":
      "рдпрд╣ AI рд╕рд╣рд╛рдпрдХ рдЖрдкрдХреЛ рдкреНрд░рд╛рдЪреАрди рднрд╛рд░рддреАрдп рдЬреНрдЮрд╛рди рдФрд░ рджрд░реНрд╢рди рд╕реАрдЦрдиреЗ рдореЗрдВ рдорджрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред",
    "I apologize, but I encountered an error. Please try again later.":
      "рдорд╛рдлрд╝реА рдЪрд╛рд╣рддрд╛ рд╣реВрдБ, рд▓реЗрдХрд┐рди рдореБрдЭреЗ рдПрдХ рддреНрд░реБрдЯрд┐ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рдирд╛ рдкрдбрд╝рд╛ред рдХреГрдкрдпрд╛ рдмрд╛рдж рдореЗрдВ рдкреБрдирдГ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред",
  },
};

export const languageSlice = createSlice({
  name: "language",
  initialState: {
    current: getInitialLanguage(),
  },
  reducers: {
    setLanguage: (state, action) => {
      state.current = action.payload;
      try {
        // Also update the settings in localStorage
        const settings = localStorage.getItem("gurukul_settings");
        if (settings) {
          const parsed = JSON.parse(settings);
          parsed.language = action.payload;
          localStorage.setItem("gurukul_settings", JSON.stringify(parsed));
          // Backup to sessionStorage
          sessionStorage.setItem("gurukul_settings", JSON.stringify(parsed));
        } else {
          localStorage.setItem(
            "gurukul_settings",
            JSON.stringify({
              language: action.payload,
              notifications: true,
            })
          );
          // Backup to sessionStorage
          sessionStorage.setItem(
            "gurukul_settings",
            JSON.stringify({
              language: action.payload,
              notifications: true,
            })
          );
        }
        // Update HTML attribute
        document.documentElement.setAttribute("data-language", action.payload);
      } catch (error) {
        console.error("Error updating language in storage:", error);
      }
    },
  },
});

export const { setLanguage } = languageSlice.actions;

// Selector to get current language
export const selectLanguage = (state) => state.language.current;

// Translation function
export const translate = (text, language = null) => {
  // If no language specified, try to get from localStorage
  if (!language) {
    try {
      const settings = localStorage.getItem("gurukul_settings");
      if (settings) {
        const parsed = JSON.parse(settings);
        language = parsed.language;
      }
    } catch (error) {
      console.error("Error reading language from storage:", error);
      language = "english";
    }
  }

  if (language === "hindi" && translations.hindi[text]) {
    return translations.hindi[text];
  }
  return text;
};

export default languageSlice.reducer;
